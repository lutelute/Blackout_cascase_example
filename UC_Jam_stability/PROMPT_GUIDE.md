# IEEE 30-Bus 統合電力系統解析ツール 作成プロンプト

## 基本プロンプト

```
電力系統解析の統合ツールをHTML/JavaScriptで作成してください。
IEEE 30-Bus標準系統をベースに、以下の4つの解析機能をタブで切り替えられるようにしてください。

## 1. Unit Commitment（UC）計画
- 24時間の発電機起動停止スケジュール
- 経済負荷配分（限界費用ベース）
- 発電コスト関数: C(P) = a + b*P + c*P²
- 起動費・停止費を考慮
- 負荷パターン選択（典型、産業用、住宅用、ダックカーブ）
- スケジュールグリッドでクリックによるON/OFF切替
- 時刻スライダーと自動再生機能

## 2. 系統混雑解析
- DC潮流計算（Bマトリクス法）
- 系統図の可視化
  - 潮流方向を矢印で表示
  - ブランチ負荷率で線の太さ・色を変更
  - バス電圧で色分け
- ブランチ脱落シミュレーション
- カスケード停電シミュレーション（過負荷による連鎖脱落）
- 送電損失計算

## 3. 電圧安定度解析
- 全バスの電圧プロファイル表示
- dQ/dV指標の計算と可視化
- PV曲線（負荷-電圧特性）
- QV曲線（無効電力-電圧特性）
- 最脆弱バスの特定
- 負荷余裕の計算

## 4. 事故時安定度解析
- P-δ曲線（等面積法）
- CCT（Critical Clearing Time）計算
- N-1解析（全ブランチ脱落ケース評価）
- 事故シミュレーション（位相角の時間応答）
- 発電機パラメータ表示（H, X'd）

## 技術要件
- 単一HTMLファイルで完結
- Chart.js使用（CDN読み込み）
- レスポンシブデザイン
- ダークテーマUI
- リアルタイム更新
```

---

## 詳細プロンプト（段階的に作成する場合）

### ステップ1: データ構造とUI骨格

```
IEEE 30-Bus系統のデータ構造を定義し、タブ切り替え可能なUIを作成してください。

データ:
- バス: 30ノード（Slack 1、PV 5、PQ 24）
- ブランチ: 41本（インピーダンス、送電容量）
- 発電機: 6台（Bus 1,2,5,8,11,13）

各発電機パラメータ:
- Pmin, Pmax: 出力範囲
- a, b, c: コスト係数
- startup: 起動費
- H: 慣性定数
- Xdp: 過渡リアクタンス

UIレイアウト:
- ヘッダー: 主要指標（発電量、負荷、電圧、CCT）
- タブナビゲーション: 4つの解析モード
- 各タブにサマリーカード、コントロール、チャート、テーブル
```

### ステップ2: UC計画機能

```
Unit Commitment機能を実装してください。

機能:
1. 24時間の負荷曲線生成（パターン選択可能）
2. 発電機スケジュールグリッド
   - 行: 発電機
   - 列: 時刻（0-23時）
   - セルクリックでON/OFF切替
3. 経済負荷配分アルゴリズム
   - 限界費用 λ = b + 2c*P
   - Pmin ≤ P ≤ Pmax 制約
4. コスト計算
   - 燃料費: Σ(a + b*P + c*P²)
   - 起動費: 前時刻OFFから起動時に加算
5. チャート
   - 負荷曲線と供給曲線
   - 時刻別コスト内訳（スタック棒グラフ）
```

### ステップ3: 潮流計算と系統図

```
DC潮流計算と系統図可視化を実装してください。

潮流計算:
1. Bマトリクス構築
   B[i][j] = -1/x[ij]（i≠j）
   B[i][i] = Σ(1/x[ik])
2. 有効電力注入ベクトル P = Pgen - Pload
3. 位相角計算 θ = B⁻¹ * P（Slackバス除外）
4. ブランチ潮流 Pij = (θi - θj) / xij

系統図:
- Canvas描画
- バス位置は事前定義
- ブランチ: 負荷率で色分け（緑→黄→赤）
- バス: 電圧で色分け、タイプで大きさ変更
- 潮流方向を矢印で表示
```

### ステップ4: 電圧安定度解析

```
電圧安定度解析機能を実装してください。

dQ/dV計算:
dQ/dV = 2V * ΣB - Qload/V
- 正: 安定
- 0に近い: 不安定に近づく

PV曲線:
1. 負荷倍率を0.5→2.0まで増加
2. 各点で潮流計算
3. 指定バスの電圧をプロット
4. 電圧崩壊点（ノーズ点）を検出

QV曲線:
1. 電圧を0.7→1.1puまで変化
2. 各点で必要な無効電力を計算
3. V-Q平面にプロット
4. Q=0となる点が運転点
```

### ステップ5: 過渡安定度解析

```
過渡安定度解析機能を実装してください。

P-δ曲線:
Pe = (E'V/X) * sin(δ)
- E': 内部電圧（≈1.05pu）
- V: 系統電圧（≈1.0pu）
- X: 等価リアクタンス（X'd + 外部）

CCT計算（等面積法）:
1. 初期位相角 δ0 = arcsin(Pm/Pmax)
2. 臨界位相角 δcr = π - δ0
3. CCT = √(2H(δcr-δ0)/(ω0*Pm))

N-1解析:
1. 各ブランチを順番に脱落
2. 潮流再計算
3. 判定基準:
   - 最大負荷率 < 100%
   - 最低電圧 > 0.9pu
   - min CCT > 0.1s

時間領域シミュレーション:
dδ/dt = ω
dω/dt = (Pm - Pe) / (2H) * ω0
- 事故中: Pe = 0
- 事故後: Pe = Pmax * sin(δ)
```

---

## カスタマイズ用プロンプト

### 系統データ変更

```
IEEE 30-Busの代わりに以下の系統データを使用してください:
[ここに新しい系統データを記載]

バス数: XX
ブランチ数: XX
発電機数: XX
```

### 機能追加

```
以下の機能を追加してください:

1. OPF（最適潮流計算）
   - 目的関数: 総発電コスト最小化
   - 制約: 潮流方程式、電圧範囲、線路容量

2. 再生可能エネルギー
   - 太陽光・風力の出力パターン
   - 出力変動のシミュレーション
   - 予備力要件の計算

3. 需要応答
   - 負荷削減の効果
   - ピークシフト
```

### UI変更

```
UIを以下のように変更してください:

- カラーテーマ: ライトモード追加
- 言語: 英語/日本語切替
- エクスポート: CSV/PNG出力機能
- 印刷: レポート形式での印刷
```

---

## トラブルシューティング用プロンプト

### 潮流計算が収束しない場合

```
潮流計算が収束しません。以下を確認・修正してください:

1. Bマトリクスの特異性チェック
2. 反復回数の増加（50→100）
3. ダンピング係数の導入
4. 初期値の改善
```

### チャートが表示されない場合

```
Chart.jsのチャートが表示されません。以下を確認してください:

1. CDN読み込みの確認
2. Canvas要素のサイズ設定
3. データセットの形式
4. updateメソッドの呼び出し
```

---

## 参考情報

### IEEE 30-Bus系統の特徴
- 米国の電力系統をモデル化
- 学術研究で広く使用される標準テストケース
- 現実的な複雑さを持ちながら計算が容易

### 計算アルゴリズムの選択
- DC潮流: 高速だが近似、リアルタイム用
- Newton-Raphson: 高精度、収束性良好
- Gauss-Seidel: 実装簡単、収束遅い

### 安定度解析の種類
- 定態安定度: 微小擾乱に対する安定性
- 過渡安定度: 大擾乱後の同期維持
- 電圧安定度: 負荷増加に対する電圧維持
